{"version":3,"sources":["App.module.css","ImportUsers/ImportUsers.module.css","ImportUsers/parser.js","ImportUsers/ImportUsers.js","UserList/columns.js","UserList/validators.js","UserList/UserList.js","App.js","index.js","UserList/UserList.module.css"],"names":["module","exports","CSV_FIELDS_PARSERS","key","getValue","required","number","value","JSON","parse","error","split","noop","csvToUserList","csv","trim","map","user","index","reduce","acc","parser","id","Number","Error","ImportUsers","fileReader","FileReader","handleReaderException","props","onError","handleReaderResult","onChange","result","handleChange","event","file","target","files","readAsText","this","onload","onerror","className","styles","type","style","display","React","Component","TABLE_COLUMNS","label","getDisplayValue","isValid","name","phone","padStart","substr","test","email","EmailValidator","age","isInteger","experience","income","toFixed","hasChildren","toString","toUpperCase","children","states","join","expires","date","some","format","moment","license","_","users","find","compare","field","toLowerCase","UserList","header","column","cell","_index","cls","App","state","handleImportError","setState","handleUsersChange","Container","ReactDOM","render","document","getElementById"],"mappings":"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","file":"static/js/main.fb6f91f7.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"Container\":\"App_Container__10KOh\",\"error\":\"App_error__1umzI\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"ImportUsers\":\"ImportUsers_ImportUsers__20WwI\"};","const CSV_FIELDS_PARSERS = [\n  {\n    key: 'name',\n    getValue: required,\n  },\n  {\n    key: 'phone',\n    getValue: required,\n  },\n  {\n    key: 'email',\n    getValue: required,\n  },\n  {\n    key: 'age',\n    getValue: number,\n  },\n  {\n    key: 'experience',\n    getValue: number,\n  },\n  {\n    key: 'income',\n    getValue: number,\n  },\n  {\n    key: 'hasChildren',\n    getValue: boolean,\n  },\n  {\n    key: 'states',\n    getValue: array,\n  },\n  {\n    key: 'expires',\n    getValue: noop,\n  },\n  {\n    key: 'license',\n    getValue: noop,\n  },\n];\n\nexport function csvToUserList(csv) {\n  return csv\n    .trim()\n    .split('\\n')\n    .map((user, index) => user\n      .split(',')\n      .reduce((acc, value, index) => {\n        const parser = CSV_FIELDS_PARSERS[index];\n\n        return {\n          ...acc,\n          [parser.key]: parser.getValue(value.trim()),\n        };\n      }, {\n        id: index + 1,\n      })\n    );\n}\n\nfunction array(value) {\n  return value.split('|');\n}\n\nfunction number(value) {\n  if (!value) {\n    return value;\n  }\n  return Number(value);\n}\n\nfunction boolean(value) {\n  try {\n    return JSON.parse(value || 'false');\n  } catch (error) {\n    return value;\n  }\n}\n\nfunction noop(value) {\n  return value;\n}\n\nfunction required(value) {\n  if (!value) {\n    throw new Error();\n  }\n\n  return value;\n}\n","import React from 'react';\n\nimport { csvToUserList } from './parser';\n\nimport styles from './ImportUsers.module.css'\n\nclass ImportUsers extends React.Component {\n\n  fileReader = new FileReader();\n\n  componentDidMount() {\n    this.fileReader.onload = this.handleReaderResult;\n    this.fileReader.onerror = this.handleReaderException;\n  }\n\n  render() {\n    return (\n      <label className={styles.ImportUsers}>\n        Import users\n        <input\n          type=\"file\"\n          style={{ display: 'none' }}\n          onChange={this.handleChange}\n        />\n      </label>\n    );\n  }\n\n  handleReaderException = () => {\n    this.props.onError();\n  };\n\n  handleReaderResult = () => {\n    const { onError, onChange } = this.props;\n\n    try {\n      onChange(csvToUserList(this.fileReader.result));\n    } catch (error) {\n      onError();\n    }\n  };\n\n  handleChange = (event) => {\n    const [file] = event.target.files;\n\n    this.fileReader.readAsText(file);\n    event.target.value = null;\n  };\n}\n\nexport default ImportUsers;\n","import {\n  validateAge,\n  validateEmail,\n  validateExperience,\n  validateHasChildren,\n  validateIncome,\n  validateLicense,\n  validateExpires,\n  validatePhone\n} from './validators';\n\nexport const TABLE_COLUMNS = [\n  {\n    label: 'ID',\n    getDisplayValue(user) {\n      return user.id;\n    },\n    isValid() {\n      return true;\n    }\n  },\n  {\n    label: 'Full Name',\n    getDisplayValue(user) {\n      return user.name;\n    },\n    isValid() {\n      return true;\n    }\n  },\n  {\n    label: 'Phone',\n    getDisplayValue(user) {\n      if (!this.isValid(user)) {\n        return user.phone;\n      }\n\n      const phone = user.phone\n        .padStart(12, '*')\n        .substr(2);\n\n      return `+1${phone}`;\n    },\n    isValid(user) {\n      return validatePhone(user.phone);\n    },\n  },\n  {\n    label: 'Email',\n    getDisplayValue(user) {\n      return user.email;\n    },\n    isValid(user) {\n      return validateEmail(user.email);\n    },\n  },\n  {\n    label: 'Age',\n    getDisplayValue(user) {\n      return user.age;\n    },\n    isValid(user) {\n      return validateAge(user.age);\n    }\n  },\n  {\n    label: 'Experience',\n    getDisplayValue(user) {\n      return user.experience;\n    },\n    isValid(user) {\n      return validateExperience(user.experience, user.age);\n    }\n  },\n  {\n    label: 'Yearly Income',\n    getDisplayValue(user) {\n      return user.income && user.income.toFixed(2);\n    },\n    isValid(user) {\n      return validateIncome(user.income);\n    }\n  },\n  {\n    label: 'Has children',\n    getDisplayValue(user) {\n      if (!this.isValid(user)) {\n        return user.hasChildren;\n      }\n\n      return user.hasChildren.toString()\n        .toUpperCase();\n    },\n    isValid(user) {\n      return validateHasChildren(user.hasChildren);\n    },\n  },\n  {\n    label: 'License states',\n    getDisplayValue(user) {\n      return user.states.join(', ');\n    },\n    isValid() {\n      return true;\n    }\n  },\n  {\n    label: 'Expiration date',\n    getDisplayValue(user) {\n      return user.expires;\n    },\n    isValid(user) {\n      return validateExpires(user.expires);\n    }\n  },\n  {\n    label: 'License number',\n    getDisplayValue(user) {\n      return user.license;\n    },\n    isValid(user) {\n      return validateLicense(user.license);\n    },\n  },\n  {\n    label: 'Duplicate with',\n    getDisplayValue(user, _, users) {\n      const result = users.find(compare => {\n        if (compare.id === user.id) {\n          return false;\n        }\n\n        return [\n          'phone',\n          'email'\n        ].some(field => {\n          return user[field].toLowerCase() === compare[field].toLowerCase();\n        });\n      });\n\n      if (!result) {\n        return null;\n      }\n\n      return result.id;\n    },\n    isValid() {\n      return true;\n    }\n  },\n];\n","import * as EmailValidator from 'email-validator';\nimport moment from 'moment';\n\nconst MIN_AGE = 21;\nconst MAX_YEAR_INCOME = 1000000;\n\nexport function validateName() {\n  return true;\n}\n\nexport function validatePhone(value) {\n  return /^(\\+1|1)?\\d{10}$/.test(value);\n}\n\nexport function validateEmail(email) {\n  return EmailValidator.validate(email);\n}\n\nexport function validateAge(age) {\n  return age === '' || (Number.isInteger(age) && age >= MIN_AGE);\n}\n\nexport function validateExperience(experience, age) {\n  return experience === '' || (experience >= 0 && ((age - experience) >= 0));\n}\n\nexport function validateHasChildren(children) {\n  return children === '' || typeof children === 'boolean';\n}\n\nexport function validateIncome(income) {\n  return income === '' || income <= MAX_YEAR_INCOME;\n}\n\nexport function validateExpires(date) {\n  const formats = [\n    /^\\d{2}\\/\\d{2}\\/\\d{4}$/,\n    /^\\d{4}-\\d{2}-\\d{2}$/,\n  ];\n\n  if (date === '') {\n    return true;\n  }\n\n  const isFormatSupported = formats.some(format => format.test(date));\n\n  if (!isFormatSupported) {\n    return false;\n  }\n\n  if (!moment(date).isValid()) {\n    return false;\n  }\n\n  return (moment(date) - moment()) > 0;\n}\n\nexport function validateLicense(license) {\n  return license === '' || /^[\\d\\w]{6}$/.test(license);\n}\n","import cls from 'classnames';\n\nimport { TABLE_COLUMNS } from './columns';\n\nimport styles from './UserList.module.css';\n\nfunction UserList(props) {\n  const { users } = props;\n\n  if (!users) {\n    return null;\n  }\n\n  return (\n    <table className={styles.UserList}>\n      <thead className={styles.header}>\n      <tr>\n        {\n          TABLE_COLUMNS.map((column, index) => (\n            <th className={styles.cell} key={index}>\n              {column.label}\n            </th>\n          ))\n        }\n      </tr>\n      </thead>\n      <tbody>\n      {\n        users.map((user, index, users) => (\n          <tr key={user.id}>\n            {\n              TABLE_COLUMNS.map((column, _index) => {\n                return (\n                  <td\n                    key={_index}\n                    className={cls(styles.cell, {\n                      [styles.error]: !column.isValid(user)\n                    })}\n                  >\n                    {column.getDisplayValue(user, index, users)}\n                  </td>\n                );\n              })\n            }\n          </tr>\n        ))\n      }\n      </tbody>\n    </table>\n  );\n}\n\nexport default UserList;\n","import React from 'react';\n\nimport ImportUsers from './ImportUsers/ImportUsers';\nimport UserList from './UserList/UserList';\n\nimport styles from './App.module.css';\n\nclass App extends React.Component {\n  state = {\n    users: null,\n    error: null,\n  };\n\n  render() {\n    const { error, users } = this.state;\n\n    return (\n      <div className={styles.Container}>\n        <ImportUsers\n          onChange={this.handleUsersChange}\n          onError={this.handleImportError}\n        />\n        {\n          error\n            ? (\n              <div className={styles.error}>\n                <p>File format is not correct</p>\n              </div>\n            )\n            : (\n              <UserList users={users}/>\n            )\n        }\n      </div>\n    );\n  }\n\n  handleImportError = () => {\n    this.setState({ error: true });\n  };\n\n  handleUsersChange = users => {\n    this.setState({\n      users,\n      error: null\n    });\n  };\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\n\nimport App from './App';\n\nReactDOM.render(\n  <App/>,\n  document.getElementById('root')\n);\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"UserList\":\"UserList_UserList__1BpuM\",\"header\":\"UserList_header__3YhTl\",\"cell\":\"UserList_cell__2VY16\",\"error\":\"UserList_error__1_B5V\"};"],"sourceRoot":""}